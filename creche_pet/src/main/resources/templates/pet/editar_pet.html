<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro Pet - Formulário 1</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
	
</head>

<body>
	
	<div th:insert="~{layout/header}"></div>

            <!-- Conteúdo principal -->
            <main>
				<div th:replace="layout/mensagens :: mensagens"></div>
				
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Editar Cadastro do Pet</h2>
                    <a th:href="@{/exibir_pet}" class="btn btn-success">Exibir Pet</a>
                </div>
				
				

                <!--formulário -->
				
				<form th:action="@{/editar_pet}" th:object="${pet}" method="post" class="needs-validation" novalidate>
				
				  <!-- Dados do Pet -->
				  <div class="card border-secondary mb-4">
				    <div class="card-header bg-secondary text-white fw-bold">Dados do Pet</div>
				    <div class="card-body row g-3">
				      <div class="col-md-6">
				        <label for="pet" class="form-label">Nome do Pet</label>
				        <input type="text" class="form-control" id="pet" th:field="*{nome}" maxlength="50" required>
				        <div class="invalid-feedback">Informe o nome do pet.</div>
				      </div>
					  
					  <div class="col-md-3">
					  			      <label for="especie" class="form-label">Espécie</label>
					  			      <select id="especie" class="form-select" th:field="*{especie}" onchange="carregarRacas()" required>
					  			          <option value="" disabled selected>Selecione</option>
					  			          <option value="Cachorro">Cachorro</option>
					  			          <option value="Gato">Gato</option>
					  			      </select>
					  			      <div class="invalid-feedback">Informe a espécie.</div>
					  			  </div>
					  			 
					  			  <div class="col-md-3">
					  			      <label for="raca" class="form-label">Raça</label>
					  			      <select id="raca" class="form-select" th:field="*{raca}" onchange="toggleOutraRaca()" required>
					  			          <option value="" disabled selected>Selecione a espécie primeiro</option>
					  			      </select>
					  			      <div class="invalid-feedback">Informe a raça.</div>
					  			  </div>

					  			  <!-- Campo oculto para "Outra Raça" -->
					  			  <div class="col-md-3 d-none" id="outraRacaBox">
					  			      <label for="outraRaca" class="form-label">Digite a Raça</label>
					  			      <input type="text" class="form-control" id="outraRaca" placeholder="Qual raça?"
					  			             oninput="setOutraRaca()">
					  			  </div>
					  
				      <div class="col-md-4">
				        <label for="data_nascimento" class="form-label">Data de Nascimento</label>
				        <input type="date" class="form-control" id="data_nascimento" th:field="*{dataNascimento}" required>
				        <div class="invalid-feedback">Informe a data de nascimento.</div>
				      </div>
				      <div class="col-md-4">
				        <label for="peso" class="form-label">Peso (kg)</label>
				        <input type="text" class="form-control" id="peso" th:field="*{peso}" required>
				        <div class="invalid-feedback">Informe o peso.</div>
				      </div>
					  
					  <div class="col-md-4">
					      <label for="observacoes" class="form-label">Observações:</label>
					      <textarea class="form-control" id="observacoes" th:field="*{observacoes}" placeholder="Insira Observaçoes do Pet. (Exemplo: Alergia)" ></textarea>
					    </div>
				    </div>
				  </div>

				  <div class="d-grid gap-2 d-md-flex justify-content-md-end">
				    <button type="submit" class="btn btn-warning text-dark fw-bold">Próxima Página</button>
				  </div>
				  
				  <div class="text-center mt-4">
				  	<p class="fw-bold fim">1/3</p>
				  </div>


				</form>
				
				
				
				<!-- Fim Formulario-->
				
            </main>


			<div th:insert="~{layout/footer}"></div>
			
			

            <!-- Bootstrap e JavaScript -->
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>


            <!-- Inputmask JavaScript puro -->
            <script src="https://unpkg.com/inputmask@5.0.8/dist/inputmask.min.js"></script>
			

            <script>
                // Aplicar máscaras com JavaScript puro
                window.addEventListener('DOMContentLoaded', () => {
                    Inputmask("999.999.999-99").mask(document.getElementById("cpf"));
                    Inputmask("99.999.999-*").mask(document.getElementById("rg"));
                    Inputmask("(99) 99999-9999").mask(document.getElementById("telefone"));
                    Inputmask("99999-999").mask(document.getElementById("cep"));
                    Inputmask("decimal", {
                        radixPoint: ",",
                        groupSeparator: ".",
                        autoGroup: true,
                        digits: 3,
                        rightAlign: false
                    }).mask(document.getElementById("peso"));
                });
            </script>

            <script>
                // Validação Bootstrap 5 ao submeter
                (function () {
                    const form = document.getElementById('cadastroForm');
                    form.addEventListener('submit', function (event) {
                        if (!form.checkValidity()) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                })();
            </script>

            <script>
                document.getElementById('cep').addEventListener('blur', function () {
                    const cep = this.value.replace(/\D/g, '');

                    if (cep.length !== 8) return;

                    fetch(`https://viacep.com.br/ws/${cep}/json/`)
                        .then(response => response.json())
                        .then(data => {
                            if (data.erro) {
                                alert('CEP não encontrado.');
                                return;
                            }

                            // Preencher os campos
                            document.getElementById('logradouro').value = data.logradouro || '';
                            document.getElementById('bairro').value = data.bairro || '';
                            document.getElementById('cidade').value = data.localidade || '';
                            document.getElementById('estado').value = data.uf || '';
                        })
                        .catch(() => {
                            alert('Erro ao buscar o CEP. Tente novamente.');
                        });
                });
            </script>
			
			<script>
					    // Define a data máxima para hoje
					    window.addEventListener('DOMContentLoaded', () => {
					        const today = new Date().toISOString().split('T')[0]; // "YYYY-MM-DD"
					        document.getElementById('data_nascimento').setAttribute('max', today);
					    });
					</script>

					
					
					
					
					<script>
					function carregarRacas() {
					    const especie = document.getElementById("especie").value;
					    const racaSelect = document.getElementById("raca");
					    const outraRacaBox = document.getElementById("outraRacaBox");
					    const outraRacaInput = document.getElementById("outraRaca");

					    // limpa opções
					    racaSelect.innerHTML = "";
					    outraRacaBox.classList.add("d-none");
					    outraRacaInput.value = "";

					    let racas = [];

					    if (especie === "Cachorro") {
					        racas = [
					            "Labrador", "Golden Retriever", "Poodle", "Bulldog",
					            "Pastor Alemão", "Shih-tzu", "Yorkshire", "Beagle",
					            "Rottweiler", "Pinscher", "Vira-lata (SRD)"
					        ];
					    }

					    if (especie === "Gato") {
					        racas = [
					            "Siamês", "Persa", "Maine Coon", "Angorá",
					            "Sphynx", "British Shorthair", "Ragdoll",
					            "Bengal", "Vira-lata (SRD)"
					        ];
					    }

					    // opção padrão
					    racaSelect.innerHTML += `<option value="" disabled selected>Selecione</option>`;

					    // adiciona as raças
					    racas.forEach(r => {
					        racaSelect.innerHTML += `<option value="${r}">${r}</option>`;
					    });

					    // adiciona "Outro"
					    racaSelect.innerHTML += `<option value="outro">Outro</option>`;
					}
					</script>

					<script>
					function toggleOutraRaca() {
					    const racaSelect = document.getElementById("raca");
					    const outraRacaBox = document.getElementById("outraRacaBox");
					    const outraRacaInput = document.getElementById("outraRaca");

					    if (racaSelect.value === "outro") {
					        outraRacaBox.classList.remove("d-none");
					        outraRacaInput.setAttribute("required", "required");
					    } else {
					        outraRacaBox.classList.add("d-none");
					        outraRacaInput.removeAttribute("required");
					        outraRacaInput.value = "";
					    }
					}

					// envia a raça digitada para o campo th:field
					function setOutraRaca() {
					    document.getElementById("raca").value = document.getElementById("outraRaca").value;
					}
					</script>





</body>

</html>

<style>
   html,
   body {
     height: 100%;
     margin: 0;
     padding: 0;
   }

   body {
     display: flex;
     flex-direction: column;
     padding-top: 140px;
     padding-bottom: 70px;
     background-color: #ffffff;
   }

   header {
     z-index: 1000;
   }

   main {
     flex: 1;
     background-color: #f4f6f8;
     padding: 2rem 1rem;
     width: 100%;
   }

   /* Centraliza o conteúdo do main */
   main > * {
     max-width: 960px;
     margin-left: auto;
     margin-right: auto;
    
   }


   footer {

     position: fixed;
     bottom: 0;
     left: 0;
     right: 0;
   }

   /* Estilo de links do menu */
   .nav-link {
     transition: background-color 0.2s, color 0.2s;
   }

   .nav-link:hover {
     background-color: #e0e0e0;
 
     color: #000;
     border-radius: 4px;
   }
 </style>