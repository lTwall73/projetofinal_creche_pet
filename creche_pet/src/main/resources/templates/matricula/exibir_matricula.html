<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Painel Administrativo - Lar dos Pets</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="../css/exibir.css" rel="stylesheet">

 
</head>

	<body>
	  <div th:insert="~{layout/header}"></div>

	  <main >
		<div th:replace="layout/mensagens :: mensagens"></div>
		
	    <div class="d-flex justify-content-between align-items-center mb-4">
	      <h2>Matrícula</h2>
	      <a th:href="@{/cadastrar_matricula}" class="btn btn-success">Nova Matrícula</a>
	    </div>

		<!-- Campo de pesquisa -->
		    <div class="mb-4">
		      <input type="text" class="form-control" placeholder="Pesquisar por ID da Turma..." id="searchInput" onkeyup="searchTable()" />
		    </div>

	    <!-- Tabela dinâmica -->
		<div th:unless="${#lists.isEmpty(matriculas)}">
	    <div class="table-responsive">
	      <table class="table table-bordered table-hover" id="matriculasTable">
	        <thead class="table-light">
	          <tr>
	            <th>ID do Pet</th>
	            <th>Turma</th>
	            <th>Data da Matrícula</th>
				<th>Ativo</th>
				
				<th>Ações</th>
	          </tr>
	        </thead>
	        <tbody>         			

	          <tr th:each="m: ${matriculas}">
				<td> <span th:each="p : ${pets}"  th:if="${p.idPet == m.idPet}" th:text="${m.idPet + ' - ' + p.nome}"></span></td>
				<td th:text="${m.idTurma}"></td>
				<td th:text="${#temporals.format(m.dataMatricula, 'dd/MM/yyyy')}"></td>
				<td th:text="${m.ativo == 'Sim' ? 'Sim' : 'Não'}"></td>
				

				
			<!--    <td th:text="${m.idPet}"></td>	
				<td th:text="${m.dataMatricula}"></td>
				<td th:text="${m.ativo}"></td> -->	
				
	            <td>
					<a th:href="@{/matricula/editar/{id}(id=${m.idMatricula})}" class="btn btn-primary">Editar</a>
				
					<a th:href="@{/matricula/excluir/{id}(id=${m.idMatricula})}" class="btn btn-danger">Excluir</a>
					
					</td>
	            </td>
	          </tr>
	        </tbody>
	      </table>
	    </div>
	  </main>

	

  <div th:insert="~{layout/footer}"></div>

  <!-- Bootstrap e JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  

  <!-- Script de busca -->
  <script>
    function searchTable() {
      const input = document.getElementById("searchInput").value.toLowerCase();
      const rows = document.querySelectorAll("#matriculasTable tbody tr");

      rows.forEach(row => {
        // Pega o texto da coluna "ID do Pet" (2ª coluna - índice 1)
        const idTurma = row.cells[1].textContent.toLowerCase();

        // Mostra ou esconde a linha conforme o texto digitado
        if (idTurma.includes(input)) {
          row.style.display = "";
        } else {
          row.style.display = "none";
        }
      });
    }
  </script>

  
 
  


</body>
</html>

